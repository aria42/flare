<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>flare.computation-graph documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Flare</span> <span class="project-version">0.1.0-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>flare</span></div></div></li><li class="depth-2 branch"><a href="flare.cache-pool.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>cache-pool</span></div></a></li><li class="depth-2 branch"><a href="flare.cnn.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>cnn</span></div></a></li><li class="depth-2 branch current"><a href="flare.computation-graph.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>computation-graph</span></div></a></li><li class="depth-2 branch"><a href="flare.compute.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>compute</span></div></a></li><li class="depth-2 branch"><a href="flare.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="flare.embeddings.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>embeddings</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>examples</span></div></div></li><li class="depth-3 branch"><a href="flare.examples.logistic-regression.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>logistic-regression</span></div></a></li><li class="depth-3"><a href="flare.examples.sentence-classification.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sentence-classification</span></div></a></li><li class="depth-2 branch"><a href="flare.generic-tensor-ops.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>generic-tensor-ops</span></div></a></li><li class="depth-2 branch"><a href="flare.graph.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>graph</span></div></a></li><li class="depth-2 branch"><a href="flare.model.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>model</span></div></a></li><li class="depth-2 branch"><a href="flare.module.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>module</span></div></a></li><li class="depth-2 branch"><a href="flare.neanderthal-ops.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>neanderthal-ops</span></div></a></li><li class="depth-2 branch"><a href="flare.node.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>node</span></div></a></li><li class="depth-2 branch"><a href="flare.optimize.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>optimize</span></div></a></li><li class="depth-2 branch"><a href="flare.report.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>report</span></div></a></li><li class="depth-2 branch"><a href="flare.rnn.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>rnn</span></div></a></li><li class="depth-2"><a href="flare.train.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>train</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="flare.computation-graph.html#var-*"><div class="inner"><span>*</span></div></a></li><li class="depth-1"><a href="flare.computation-graph.html#var-.2B"><div class="inner"><span>+</span></div></a></li><li class="depth-1"><a href="flare.computation-graph.html#var--ensure-arity"><div class="inner"><span>-ensure-arity</span></div></a></li><li class="depth-1"><a href="flare.computation-graph.html#var--ensure-same-shapes"><div class="inner"><span>-ensure-same-shapes</span></div></a></li><li class="depth-1"><a href="flare.computation-graph.html#var--forward"><div class="inner"><span>-forward</span></div></a></li><li class="depth-1"><a href="flare.computation-graph.html#var--tensor"><div class="inner"><span>-tensor</span></div></a></li><li class="depth-1"><a href="flare.computation-graph.html#var--tensor-op"><div class="inner"><span>-tensor-op</span></div></a></li><li class="depth-1"><a href="flare.computation-graph.html#var-add-graph-op"><div class="inner"><span>add-graph-op</span></div></a></li><li class="depth-1"><a href="flare.computation-graph.html#var-arg-max"><div class="inner"><span>arg-max</span></div></a></li><li class="depth-1"><a href="flare.computation-graph.html#var-concat"><div class="inner"><span>concat</span></div></a></li><li class="depth-1"><a href="flare.computation-graph.html#var-cross-entropy-loss"><div class="inner"><span>cross-entropy-loss</span></div></a></li><li class="depth-1"><a href="flare.computation-graph.html#var-dropout"><div class="inner"><span>dropout</span></div></a></li><li class="depth-1"><a href="flare.computation-graph.html#var-ensure-vector-tensor.3F.21"><div class="inner"><span>ensure-vector-tensor?!</span></div></a></li><li class="depth-1"><a href="flare.computation-graph.html#var-exp"><div class="inner"><span>exp</span></div></a></li><li class="depth-1"><a href="flare.computation-graph.html#var-generate-equations"><div class="inner"><span>generate-equations</span></div></a></li><li class="depth-1"><a href="flare.computation-graph.html#var-GraphOp"><div class="inner"><span>GraphOp</span></div></a></li><li class="depth-2 branch"><a href="flare.computation-graph.html#var-forward-shape"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>forward-shape</span></div></a></li><li class="depth-2 branch"><a href="flare.computation-graph.html#var-op-descriptor"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>op-descriptor</span></div></a></li><li class="depth-2 branch"><a href="flare.computation-graph.html#var-op-key"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>op-key</span></div></a></li><li class="depth-2"><a href="flare.computation-graph.html#var-op-validate.21"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>op-validate!</span></div></a></li><li class="depth-1"><a href="flare.computation-graph.html#var-hadamard"><div class="inner"><span>hadamard</span></div></a></li><li class="depth-1"><a href="flare.computation-graph.html#var-max"><div class="inner"><span>max</span></div></a></li><li class="depth-1"><a href="flare.computation-graph.html#var-scalar-op"><div class="inner"><span>scalar-op</span></div></a></li><li class="depth-1"><a href="flare.computation-graph.html#var-scale"><div class="inner"><span>scale</span></div></a></li><li class="depth-1"><a href="flare.computation-graph.html#var-sigmoid"><div class="inner"><span>sigmoid</span></div></a></li><li class="depth-1"><a href="flare.computation-graph.html#var-split"><div class="inner"><span>split</span></div></a></li><li class="depth-1"><a href="flare.computation-graph.html#var-squeeze"><div class="inner"><span>squeeze</span></div></a></li><li class="depth-1"><a href="flare.computation-graph.html#var-strech"><div class="inner"><span>strech</span></div></a></li><li class="depth-1"><a href="flare.computation-graph.html#var-sum-elems"><div class="inner"><span>sum-elems</span></div></a></li><li class="depth-1"><a href="flare.computation-graph.html#var-summarize-computation"><div class="inner"><span>summarize-computation</span></div></a></li><li class="depth-1"><a href="flare.computation-graph.html#var-tanh"><div class="inner"><span>tanh</span></div></a></li><li class="depth-1"><a href="flare.computation-graph.html#var-TensorOp"><div class="inner"><span>TensorOp</span></div></a></li><li class="depth-2 branch"><a href="flare.computation-graph.html#var-backward-node-pass.21"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>backward-node-pass!</span></div></a></li><li class="depth-2 branch"><a href="flare.computation-graph.html#var-ensure-valid.3F.21"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ensure-valid?!</span></div></a></li><li class="depth-2"><a href="flare.computation-graph.html#var-forward-node-pass.21"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>forward-node-pass!</span></div></a></li><li class="depth-1"><a href="flare.computation-graph.html#var-vec-remove"><div class="inner"><span>vec-remove</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">flare.computation-graph</h1><div class="doc"><div class="markdown"><p>Abstractions for constructing computation graphs using graph operations. The public methods for operations are at bottom of this ns. The key protocols are as follows:</p>
<ul>
  <li><code>GraphOp</code> a computational graph operation that knows nothing about tensor  implementation, but can validate if inputs nodes are valid and predict  output shape</li>
  <li><code>TensorOp</code> an implementation of a specific graph operation which performs  forward/backwad operation.</li>
</ul></div></div><div class="public anchor" id="var-*"><h3>*</h3><div class="usage"><code>(* &amp; inputs)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/aria42/flare/tree/master/src/flare/computation_graph.clj#L388">view source</a></div></div><div class="public anchor" id="var-.2B"><h3>+</h3><div class="usage"><code>(+ &amp; inputs)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/aria42/flare/tree/master/src/flare/computation_graph.clj#L385">view source</a></div></div><div class="public anchor" id="var--ensure-arity"><h3>-ensure-arity</h3><div class="usage"><code>(-ensure-arity expected-arity input-nodes)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/aria42/flare/tree/master/src/flare/computation_graph.clj#L158">view source</a></div></div><div class="public anchor" id="var--ensure-same-shapes"><h3>-ensure-same-shapes</h3><div class="usage"><code>(-ensure-same-shapes nodes)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/aria42/flare/tree/master/src/flare/computation_graph.clj#L164">view source</a></div></div><div class="public anchor" id="var--forward"><h3>-forward</h3><div class="usage"><code>(-forward node factory cache)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/aria42/flare/tree/master/src/flare/computation_graph.clj#L78">view source</a></div></div><div class="public anchor" id="var--tensor"><h3>-tensor</h3><div class="usage"><code>(-tensor node key factory cache)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/aria42/flare/tree/master/src/flare/computation_graph.clj#L71">view source</a></div></div><div class="public anchor" id="var--tensor-op"><h3>-tensor-op</h3><div class="usage"><code>(-tensor-op node factory)</code></div><div class="doc"><div class="markdown"><p>valdiates that tensor op valid for a computation, and returns <code>TensorOp</code></p></div></div><div class="src-link"><a href="https://github.com/aria42/flare/tree/master/src/flare/computation_graph.clj#L61">view source</a></div></div><div class="public anchor" id="var-add-graph-op"><h3>add-graph-op</h3><div class="usage"><code>(add-graph-op op nodes)</code></div><div class="doc"><div class="markdown"><p>create a new node using a <code>GraphOp</code> and a sequence of nodes. If in <code>eager?</code> mode, will execute the tensor operation as well and result will be in <code>:tensor</code> field on returned node</p>
<p>The <code>nodes</code> inputs will be on the <code>:children</code> field of returned <code>Node</code></p></div></div><div class="src-link"><a href="https://github.com/aria42/flare/tree/master/src/flare/computation_graph.clj#L94">view source</a></div></div><div class="public anchor" id="var-arg-max"><h3>arg-max</h3><div class="usage"><code>(arg-max x)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/aria42/flare/tree/master/src/flare/computation_graph.clj#L417">view source</a></div></div><div class="public anchor" id="var-concat"><h3>concat</h3><div class="usage"><code>(concat dim &amp; inputs)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/aria42/flare/tree/master/src/flare/computation_graph.clj#L421">view source</a></div></div><div class="public anchor" id="var-cross-entropy-loss"><h3>cross-entropy-loss</h3><div class="usage"><code>(cross-entropy-loss activations label)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/aria42/flare/tree/master/src/flare/computation_graph.clj#L391">view source</a></div></div><div class="public anchor" id="var-dropout"><h3>dropout</h3><div class="usage"><code>(dropout p input)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/aria42/flare/tree/master/src/flare/computation_graph.clj#L409">view source</a></div></div><div class="public anchor" id="var-ensure-vector-tensor.3F.21"><h3>ensure-vector-tensor?!</h3><div class="usage"><code>(ensure-vector-tensor?! prefix shape)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/aria42/flare/tree/master/src/flare/computation_graph.clj#L236">view source</a></div></div><div class="public anchor" id="var-exp"><h3>exp</h3><div class="usage"><code>(exp input)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/aria42/flare/tree/master/src/flare/computation_graph.clj#L400">view source</a></div></div><div class="public anchor" id="var-generate-equations"><h3>generate-equations</h3><div class="usage"><code>(generate-equations target)</code></div><div class="doc"><div class="markdown"><p>generate semi-readable equations for computations in DAG represented by <code>target</code></p></div></div><div class="src-link"><a href="https://github.com/aria42/flare/tree/master/src/flare/computation_graph.clj#L120">view source</a></div></div><div class="public anchor" id="var-GraphOp"><h3>GraphOp</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>Graph operation only needs to be aware of shape of output, independent of any tensor implementation.</p></div></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var-forward-shape"><h3>forward-shape</h3><div class="usage"><code>(forward-shape this input-shapes)</code></div><div class="doc"><div class="markdown"><p>returns the shape of the operation</p></div></div></div><div class="public anchor" id="var-op-descriptor"><h3>op-descriptor</h3><div class="usage"><code>(op-descriptor this)</code></div><div class="doc"><div class="markdown"><p>returns a text description of the operation, useful for generating equations of the graph computations, can include the shape or other arguments</p></div></div></div><div class="public anchor" id="var-op-key"><h3>op-key</h3><div class="usage"><code>(op-key this)</code></div><div class="doc"><div class="markdown"><p>A keyword that uniquely identifies the graph operation, useful for connecting to a tensor implementation.</p></div></div></div><div class="public anchor" id="var-op-validate.21"><h3>op-validate!</h3><div class="usage"><code>(op-validate! this nodes)</code></div><div class="doc"><div class="markdown"><p>throws exception if the operation isnâ€™t valid for the argument nodes</p></div></div></div></div></div><div class="src-link"><a href="https://github.com/aria42/flare/tree/master/src/flare/computation_graph.clj#L27">view source</a></div></div><div class="public anchor" id="var-hadamard"><h3>hadamard</h3><div class="usage"><code>(hadamard x y)</code></div><div class="doc"><div class="markdown"><p>Output is element-wise product of two inputs</p></div></div><div class="src-link"><a href="https://github.com/aria42/flare/tree/master/src/flare/computation_graph.clj#L412">view source</a></div></div><div class="public anchor" id="var-max"><h3>max</h3><div class="usage"><code>(max &amp; inputs)</code></div><div class="doc"><div class="markdown"><p>Inputs: Tensors of same shape Output: Tensor of input shape where each element is maximum</p></div></div><div class="src-link"><a href="https://github.com/aria42/flare/tree/master/src/flare/computation_graph.clj#L428">view source</a></div></div><div class="public anchor" id="var-scalar-op"><h3>scalar-op</h3><div class="usage"><code>(scalar-op key)</code></div><div class="doc"><div class="markdown"><p>graph operation of single argument where output is same shape</p></div></div><div class="src-link"><a href="https://github.com/aria42/flare/tree/master/src/flare/computation_graph.clj#L368">view source</a></div></div><div class="public anchor" id="var-scale"><h3>scale</h3><div class="usage"><code>(scale scale node)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/aria42/flare/tree/master/src/flare/computation_graph.clj#L445">view source</a></div></div><div class="public anchor" id="var-sigmoid"><h3>sigmoid</h3><div class="usage"><code>(sigmoid input)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/aria42/flare/tree/master/src/flare/computation_graph.clj#L403">view source</a></div></div><div class="public anchor" id="var-split"><h3>split</h3><div class="usage"><code>(split node dim &amp; split-indices)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/aria42/flare/tree/master/src/flare/computation_graph.clj#L434">view source</a></div></div><div class="public anchor" id="var-squeeze"><h3>squeeze</h3><div class="usage"><code>(squeeze input dim-to-squeeze)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/aria42/flare/tree/master/src/flare/computation_graph.clj#L394">view source</a></div></div><div class="public anchor" id="var-strech"><h3>strech</h3><div class="usage"><code>(strech input dim-to-insert)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/aria42/flare/tree/master/src/flare/computation_graph.clj#L397">view source</a></div></div><div class="public anchor" id="var-sum-elems"><h3>sum-elems</h3><div class="usage"><code>(sum-elems node)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/aria42/flare/tree/master/src/flare/computation_graph.clj#L442">view source</a></div></div><div class="public anchor" id="var-summarize-computation"><h3>summarize-computation</h3><div class="usage"><code>(summarize-computation target indent)</code><code>(summarize-computation target)</code></div><div class="doc"><div class="markdown"><p>Create informative s-expression for computation</p></div></div><div class="src-link"><a href="https://github.com/aria42/flare/tree/master/src/flare/computation_graph.clj#L131">view source</a></div></div><div class="public anchor" id="var-tanh"><h3>tanh</h3><div class="usage"><code>(tanh input)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/aria42/flare/tree/master/src/flare/computation_graph.clj#L406">view source</a></div></div><div class="public anchor" id="var-TensorOp"><h3>TensorOp</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>A tensor op executes a given <code>GraphOp</code> in a tensor implementation</p></div></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var-backward-node-pass.21"><h3>backward-node-pass!</h3><div class="usage"><code>(backward-node-pass! this node)</code></div><div class="doc"><div class="markdown"><p>compute the <code>:grad</code> gradient tensor on each child of passed in node reaching down to the leaves (which include the parameter nodes). Returns the node so that downstream backward-node-pass! calls can use added data.</p></div></div></div><div class="public anchor" id="var-ensure-valid.3F.21"><h3>ensure-valid?!</h3><div class="usage"><code>(ensure-valid?! this input-nodes)</code></div><div class="doc"><div class="markdown"><p>Ensure the operation can be perfed with the tensor operation. Some impls may support limited dimension or sizes</p></div></div></div><div class="public anchor" id="var-forward-node-pass.21"><h3>forward-node-pass!</h3><div class="usage"><code>(forward-node-pass! this node)</code></div><div class="doc"><div class="markdown"><p>compute the forward pass of the algorithm, for each node, compute <code>:value</code> tensor for passed in node, using the <code>:children</code> nodes and their <code>:value</code> tensors. Returns the node in case any other computations are added to the node for use in the backward pass.</p></div></div></div></div></div><div class="src-link"><a href="https://github.com/aria42/flare/tree/master/src/flare/computation_graph.clj#L42">view source</a></div></div><div class="public anchor" id="var-vec-remove"><h3>vec-remove</h3><div class="usage"><code>(vec-remove coll pos)</code></div><div class="doc"><div class="markdown"><p>remove elem in coll</p></div></div><div class="src-link"><a href="https://github.com/aria42/flare/tree/master/src/flare/computation_graph.clj#L192">view source</a></div></div></div></body></html>